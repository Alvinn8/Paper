From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: BillyGalbreath <Blake.Galbreath@GMail.com>
Date: Sat, 21 Jul 2018 01:59:59 -0500
Subject: [PATCH] PlayerElytraBoostEvent


diff --git a/src/main/java/net/minecraft/world/item/FireworkRocketItem.java b/src/main/java/net/minecraft/world/item/FireworkRocketItem.java
index f2989c0e7fbf900366df13d0609c1a1bee9c681d..e122eba78c498eeacd0138fdee8ce5eb6464da55 100644
--- a/src/main/java/net/minecraft/world/item/FireworkRocketItem.java
+++ b/src/main/java/net/minecraft/world/item/FireworkRocketItem.java
@@ -3,6 +3,7 @@ package net.minecraft.world.item;
 import java.util.Arrays;
 import java.util.Comparator;
 import net.minecraft.core.Direction;
+import net.minecraft.server.level.ServerPlayer;
 import net.minecraft.world.InteractionHand;
 import net.minecraft.world.InteractionResult;
 import net.minecraft.world.InteractionResultHolder;
@@ -40,11 +41,16 @@ public class FireworkRocketItem extends Item {
                 // Paper start
                 final FireworkRocketEntity entityfireworks = new FireworkRocketEntity(level, itemStack, player);
                 entityfireworks.spawningEntity = player.getUUID();
-                level.addFreshEntity(entityfireworks);
-                // Paper end
-                if (!player.abilities.instabuild) {
-                    itemStack.shrink(1);
+                // Paper start
+                com.destroystokyo.paper.event.player.PlayerElytraBoostEvent event = new com.destroystokyo.paper.event.player.PlayerElytraBoostEvent((org.bukkit.entity.Player) player.getBukkitEntity(), org.bukkit.craftbukkit.inventory.CraftItemStack.asCraftMirror(itemStack), (org.bukkit.entity.Firework) entityfireworks.getBukkitEntity());
+                if (event.callEvent() && level.addFreshEntity(entityfireworks)) {
+                    if (event.shouldConsume() && !player.abilities.instabuild) {
+                        itemStack.shrink(1);
+                    } else ((ServerPlayer) player).getBukkitEntity().updateInventory();
+                } else if (player instanceof ServerPlayer) {
+                    ((ServerPlayer) player).getBukkitEntity().updateInventory();
                 }
+                // Paper end
             }
 
             return InteractionResultHolder.sidedSuccess(player.getItemInHand(interactionHand), level.isClientSide());
