From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: BillyGalbreath <blake.galbreath@gmail.com>
Date: Tue, 8 Dec 2020 22:06:56 -0600
Subject: [PATCH] Fix curing villager makes equipment disappear

This fixes the CB bug where curing a villager that is holding
equipment (weapons/armor) causes the items to disappear instead of drop
to the ground by forcing the items to drop instead of going to the drops
field for the EntityDeathEvent which does not fire for entity conversions.

diff --git a/src/main/java/net/minecraft/world/entity/monster/ZombieVillager.java b/src/main/java/net/minecraft/world/entity/monster/ZombieVillager.java
index 2872b1eb55110e5ed803500412b8efd2b3992a43..09b8684402e917f15d1db6676c625ecfffd6b6e2 100644
--- a/src/main/java/net/minecraft/world/entity/monster/ZombieVillager.java
+++ b/src/main/java/net/minecraft/world/entity/monster/ZombieVillager.java
@@ -221,7 +221,9 @@ public class ZombieVillager extends Zombie implements VillagerDataHolder {
                     double d0 = (double) this.getEquipmentDropChance(enumitemslot);
 
                     if (d0 > 1.0D) {
+                        this.forceDrops = true; // Paper - fix SPIGOT-6207
                         this.spawnAtLocation(itemstack);
+                        this.forceDrops = false; // Paper - fix SPIGOT-6207
                     }
                 }
             }
